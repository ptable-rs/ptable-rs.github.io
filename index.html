<!DOCTYPE html>
<html lang="en">

<head>
  <title>Pablo 11C237</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    .element-box {
      position: absolute;
      text-align: center;
      width: 50px;
      height: 50px;
    }

    .empty-space {
      position: absolute;
      width: 50px;
      height: 50px;
    }

    .big-square {
      position: absolute;
      font-weight: bold;
      width: 120px;
      height: 120px;
      background-color: rgba(0, 0, 0, 0.5);
      border: 2px solid black;
      z-index: 1;
    }

    #hovered-element-display {
      position: absolute;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid #000;
      padding: 5px;
      display: none;
    }

    #big-symbol {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 24px;
      /* Adjust the font size as needed */
      color: white;
      /* Adjust the color as needed */
    }
  </style>
</head>

<body>
  <div id="ptable-canvas" style="position: relative; width: 100%;">
    <!-- Elements and spaces will be placed here -->
  </div>
  <div id="hovered-element-display"></div>
  <script>
    const PTABLE_CONFIGURATION = [
      [true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true,],
      [true, true, false, false, false, false, false, false, false, false, false, false, true, true, true, true, true, true,],
      [true, true, false, false, false, false, false, false, false, false, false, false, true, true, true, true, true, true,],
      [true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true,],
      [true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true,],
      [true, true, false, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true,],
      [true, true, false, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true,],
      [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false,],
      [false, false, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, false,],
      [false, false, true, true, true, true, true, true, true, true, true, true, true, true, true, true, true, false,],
    ];

    const DATA_URL = 'https://raw.githubusercontent.com/orhnk/pablo/master/db/periodic-table-lookup.json';
    let ptable_db;
    fetch(DATA_URL)
      .then(response => response.json())
      .then(data => {
        ptable_db = data;
        renderElements();
      })
      .catch(error => {
        console.error('Error:', error);
        ptable_db = undefined; // Set ptable_db to undefined in case of error
      });

    function renderElements() {
      const ptableCanvas = document.getElementById('ptable-canvas');
      const hoveredElementDisplay = document.getElementById('hovered-element-display');
      const bigSquare = document.createElement('div');
      bigSquare.classList.add('big-square');
      bigSquare.style.display = 'none'; // Initially hide the big square
      ptableCanvas.appendChild(bigSquare);

      const bigSymbol = document.createElement('div');
      bigSymbol.id = 'big-symbol';
      bigSquare.appendChild(bigSymbol);

      let elementPositions = {}; // Object to store positions of elements
      let element_counter = 0;
      PTABLE_CONFIGURATION.forEach((row, rowIndex) => {
        row.forEach((isTrue, colIndex) => {
          if (isTrue) {
            const symbol = ptable_db.order[element_counter++]; // Calculate symbol based on index
            const category = ptable_db[symbol].category; // Get category information
            const elementBox = document.createElement('div');
            elementBox.classList.add('element-box');
            const element = document.createElement('p');
            element.textContent = ptable_db[symbol].symbol; // Use symbol instead of direct name
            elementBox.appendChild(element);
            const leftOffset = colIndex * 60 + 20; // Adjust left offset based on column index
            const topOffset = rowIndex * 60 + 20; // Adjust top offset based on row index
            elementBox.style.left = leftOffset + 'px';
            elementBox.style.top = topOffset + 'px';
            elementBox.style.backgroundColor = getColorByCategory(category); // Set background color based on category
            ptableCanvas.appendChild(elementBox);
            // Store the position of the element
            elementPositions[symbol] = {
              left: leftOffset,
              top: topOffset
            };
            // Add event listeners for mouseover and mouseout
            elementBox.addEventListener('mouseover', () => displayHoveredElement(symbol));
            elementBox.addEventListener('mouseout', () => hideHoveredElement());
          } else {
            // Create an empty space
            const emptySpace = document.createElement('div');
            emptySpace.classList.add('empty-space');
            const leftOffset = colIndex * 60 + 20; // Adjust left offset based on column index
            const topOffset = rowIndex * 60 + 20; // Adjust top offset based on row index
            emptySpace.style.left = leftOffset / + 'px';
            emptySpace.style.top = topOffset + 'px';
            ptableCanvas.appendChild(emptySpace);

            // Check if the empty space is between Hydrogen and Helium
            if ((colIndex === 0 && rowIndex === 0) || (colIndex === 1 && rowIndex === 0)) {
              bigSquare.style.left = leftOffset * 2 + 'px';
              bigSquare.style.top = topOffset * 2 + 'px';
            }
          }
        });
      });

      // Define function to get color based on category
      function getColorByCategory(category) {
        // Define color mappings for categories
        const colorMap = {
          'alkali metal': '#ff9999',
          'alkaline earth metal': '#ffcc66',
          'transition metal': '#99ccff',
          'post-transition metal': '#ffcc99',
          'metalloid': '#cc99ff',
          'polyatomic nonmetal': '#66cc99',
          'diatomic nonmetal': '#66cccc',
          'noble gas': '#cc99cc',
          'actinide': '#cc9999',
          'lanthanide': '#99cc99'
          // Add more categories and colors as needed
        };
        // Return the color for the given category, default to a fallback color if not found
        return colorMap[category] || '#cccccc';
      }

      // Define functions to display and hide the hovered element
      function displayHoveredElement(symbol) {
        hoveredElementDisplay.textContent = symbol;
        hoveredElementDisplay.style.display = 'block';
        const bigSymbol = document.getElementById('big-symbol');
        bigSymbol.textContent = symbol.toUpperCase(); // Set the symbol text
        const elementData = ptable_db[symbol]; // Retrieve data of the hovered element
        if (elementData) {
          const elementPosition = elementPositions[symbol];
          hoveredElementDisplay.style.left = elementPosition.left + 'px';
          hoveredElementDisplay.style.top = (elementPosition.top - 20) + 'px'; // Adjust position for better visibility
          bigSymbol.style.display = 'block'; // Show the big symbol
          bigSymbol.style.left = '50%'; // Center the symbol horizontally
          bigSymbol.style.top = '50%'; // Center the symbol vertically
          bigSquare.style.backgroundColor = getColorByCategory(elementData.category); // Set background color based on category
          bigSquare.style.display = 'block'; // Show the big square
        }
      }


      function hideHoveredElement() {
        hoveredElementDisplay.style.display = 'none';
        const bigSymbol = document.getElementById('big-symbol');
        bigSymbol.textContent = ''; // Clear the symbol text
        bigSymbol.style.display = 'none'; // Hide the big symbol
        bigSquare.style.display = 'none'; // Hide the big square
      }
    }
  </script>
</body>

</html>